{% extends "layout-admin.html.twig" %}

{% block header %}
{{ parent() }}

{% endblock %}

{% block main %}
    <h1> page pour créer un bien </h1>
    <main class="container py-5">
        <h1>
            Ajouter une propriété
        </h1>

        <form action='index.php?route=check-add-property' method="POST" enctype="multipart/form-data" class="mt-5">
            <input type="hidden" name="csrf-token" id="csrf-token" value="{{ session }}" >
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="ownerId" name="ownerId" aria-label="Floating label select example">
                    <option value="{{  propertyById.owner.id }}" selected>{{ propertyById.owner.firstName ~ " " ~ propertyById.owner.lastName }}</option>
                    {% for proprietaire in usersProprietaire  %}
                    <option value="{{  proprietaire.id }}">{{ proprietaire.firstName ~ " " ~ proprietaire.lastName }}</option>
                    {% endfor %}
                </select>
                <label for="owner">Propriétaire du bien:</label>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="tenantId" name="tenantId" aria-label="Floating label select example">
                    <option value="{{  propertyById.tenant.id }}" selected>{{ propertyById.tenant.firstName ~ " " ~ propertyById.tenant.lastName }}</option>
                    {% for locataire in usersLocataire  %}
                    <option value="{{  locataire.id }}">{{ locataire.firstName ~ " " ~ locataire.lastName }}</option>
                    {% endfor %}
                </select>
                <label for="owner">Locataire du bien:</label>
            </fieldset>
            <fieldset class="my-1">
                <legend>Caractéristiques du bien</legend>
                {% for key, features in allFeatures  %}
                <input class="form-check-input" type="checkbox" value="{{ features.id }}" name="features[]" id="features_{{ key }}">
                <label class="form-check-label" for="features_{{ key }}">
                    {{ features.propertyFeaturesName }}
                </label>
                {% endfor %}
            </fieldset>
            <fieldset class="my-1 form-group" >
                <legend>Selectionner des photos pour ce bien</legend>
                <div class="dropzone" id="dropzone">
                   <input class="form-control form-control-sm" type="file" name="formFile[]" multiple>

                </div>

<!--                   <figure>
                    <img src='{{ "../upload/" ~ media.url }}' class="img-fluid img-thumbnail" alt="...">
                    <figcaption></figcaption>
                  </figure> -->
<!--                  <label for="formFile_{{ key }}" class="form-label">Default file input example</label>
 -->            </fieldset>
            <fieldset class="my-1">
                <label for="salesPrice" class="form-label">
                    Prix de vente
                </label>
                <input type="number" name="salesPrice" id="salesPrice" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="rent" class="form-label">
                    Loyer
                </label>
                <input type="number" name="rent" id="rent" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="charge" class="form-label">
                    Charge
                </label>
                <input type="number" name="charge" id="charge" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="rentCharge" class="form-label">
                    Loyer + Charge
                </label>
                <input type="number" name="rentCharge" id="rentCharge" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="securityDeposit" class="form-label">
                    Dépôt de garantie
                </label>
                <input type="number" name="securityDeposit" id="securityDeposit" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="agencyFeesRent" class="form-label">
                    Frais d'agence
                </label>
                <input type="number" name="agencyFeesRent" id="agencyFeesRent" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="energyDiagnosticsId" name="energyDiagnosticsId" aria-label="Floating label select example">
                    {% for noteEnergy in allNoteEnergy  %}
                    <option value="{{  noteEnergy.id }}">{{ noteEnergy.note }}</option>
                    {% endfor %}
                </select>
                <label for="energyDiagnosticsId">Note diagnostique énergétique</label>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="greenhouseGasEmissionIndicesId" name="greenhouseGasEmissionIndicesId" aria-label="Floating label select example">
                    {% for noteGreenhouse in allNoteGreenhouse  %}
                    <option value='{{  noteGreenhouse.id }}'>{{ noteGreenhouse.note }}</option>
                    {% endfor %}
                </select>
                <label for="greenhouseGasEmissionIndicesId">Note emisssion gaz à effet de serre</label>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="statusId" name="statusId" aria-label="Floating label select example">
                    {% for status in allStatus  %}
                    <option value="{{  status.id }}">{{ status.statusName }}</option>
                    {% endfor %}
                </select>
                <label for="statusId">Etat de la propriété</label>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="stateId" name="stateId" aria-label="Floating label select example">
                    {% for state in allState  %}
                    <option value="{{  state.id }}">{{ state.management }}</option>
                    {% endfor %}
                </select>
                <label for="stateId">Etat de la propriété</label>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="typeId" name="typeId" aria-label="Floating label select example">
                    {% for type in allType  %}
                    <option value="{{  type.id }}">{{ type.management }}</option>
                    {% endfor %}
                </select>
                <label for="typeId">Types de propriété</label>
            </fieldset>
            <fieldset class="my-1">
                <label for="availabilityDate" class="form-label">
                    Date de disponnibilité
                </label>
                <input type="date" name="availabilityDate" id="availabilityDate" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="title" class="form-label">
                    Adresse
                </label>
                <input type="text" name="title" id="title" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="rooms" class="form-label">
                    Nombre de pièces
                </label>
                <input type="number" name="rooms" id="rooms" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="surface" class="form-label">
                    Superficie
                </label>
                <input type="number" name="surface" id="surface" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="description" class="form-label">
                    Description
                </label>
                <input type="text" name="description" id="description" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="city" class="form-label">
                    Ville
                </label>
                <input type="text" name="city" id="city" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1">
                <label for="district" class="form-label">
                    Quartier
                </label>
                <input type="text" name="district" id="district" class="form-control" value=""/>
            </fieldset>
            <fieldset class="my-1 form-floating">
                <select class="form-select" id="rentalManagementId" name="rentalManagementId" aria-label="Floating label select example">
                    {% for management in allManagement  %}
                    <option value="{{  management.id }}">{{ management.management }}</option>
                    {% endfor %}
                </select>
                <label for="rentalManagementId">Gestion locative</label>
            </fieldset>
            <button type="submit" class="mt-3 btn btn-primary">Ajouter</button>
        </form>

   
</main>
    
{% endblock %}

{% block footer %}
{% endblock %}

{% block script %}
{{ parent() }}
<script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>

<!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/min/dropzone.min.js”></script> -->
<script>
    Dropzone.options.dropzone = {
  url: "/index.php?route=check-add-property",
  autoProcessQueue: false,
  paramName: "formFile[]",
  clickable: true,
  maxFilesize: 2, //in mb
  addRemoveLinks: true,
  acceptedFiles: '.png,.jpg',
  dictDefaultMessage: "Upload your file here",
  init: function() {
    this.on("sending", function(file, xhr, formData) {
      console.log("sending file");
    });
    this.on("success", function(file, responseText) {
      console.log('great success');
    });
    this.on("addedfile", function(file){
  		console.log('file added');
  	});
  }
};
</script>
{% endblock %}